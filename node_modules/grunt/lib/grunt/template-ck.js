/*
 * grunt
 * http://gruntjs.com/
 *
 * Copyright (c) 2014 "Cowboy" Ben Alman
 * Licensed under the MIT license.
 * https://github.com/gruntjs/grunt/blob/master/LICENSE-MIT
 */"use strict";var grunt=require("../grunt"),template=module.exports={};template.date=require("dateformat");template.today=function(e){return template.date(new Date,e)};var allDelimiters={};template.addDelimiters=function(e,t,n){var r=allDelimiters[e]={};r.opener=t;r.closer=n;var i=r.opener.replace(/(.)/g,"\\$1"),s="([\\s\\S]+?)"+r.closer.replace(/(.)/g,"\\$1");r.lodash={evaluate:new RegExp(i+s,"g"),interpolate:new RegExp(i+"="+s,"g"),escape:new RegExp(i+"-"+s,"g")}};template.addDelimiters("config","<%","%>");template.setDelimiters=function(e){var t=allDelimiters[e in allDelimiters?e:"config"];grunt.util._.templateSettings=t.lodash;return t};template.process=function(e,t){t||(t={});var n=template.setDelimiters(t.delimiters),r=Object.create(t.data||grunt.config.data||{});"grunt"in r||(r.grunt=grunt);var i=e;try{while(e.indexOf(n.opener)>=0){e=grunt.util._.template(e,r);if(e===i)break;i=e}}catch(s){String(s)==="SyntaxError: Unexpected token ILLEGAL"&&/\n|\r/.test(e)&&grunt.log.errorlns("A special character was detected in this template. Inside template tags, the \\n and \\r special characters must be escaped as \\\\n and \\\\r. (grunt 0.4.0+)");s.message="An error occurred while processing a template ("+s.message+").";grunt.warn(s,grunt.fail.code.TEMPLATE_ERROR)}return grunt.util.normalizelf(e)};