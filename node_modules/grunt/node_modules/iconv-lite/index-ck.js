function toInternalEncoding(e){return new Buffer(ensureString(e),this.options.originalEncoding)}function fromInternalEncoding(e){return ensureBuffer(e).toString(this.options.originalEncoding)}function toTableEncoding(e){e=ensureString(e);var t=e.length,n=this.options.revCharsTable,r=new Buffer(t*2),i,s,o=n[iconv.defaultCharUnicode.charCodeAt(0)];for(var u=0,a=0;u<t;u++){s=e.charCodeAt(u);if(s>>7){i=n[s]||o;r[a++]=i>>8;r[a++]=i&255}else r[a++]=s}return r.slice(0,a)}function fromTableEncoding(e){e=ensureBuffer(e);var t=e.length,n=this.options.table,r=new Buffer(t*2),i,s,o=iconv.defaultCharUnicode.charCodeAt(0);for(var u=0,a=0;u<t;u++,a+=2){s=e[u];if(s&128){s=(s<<8)+e[++u];i=n[s]||o}else i=s;r[a]=i&255;r[a+1]=i>>8}return r.slice(0,a).toString("ucs2")}function toSingleByteEncoding(e){e=ensureString(e);var t=new Buffer(e.length),n=this.options.revCharsBuf;for(var r=0;r<e.length;r++)t[r]=n[e.charCodeAt(r)];return t}function fromSingleByteEncoding(e){e=ensureBuffer(e);var t=this.options.charsBuf,n=new Buffer(e.length*2),r=0,i=0;for(var s=0,o=e.length;s<o;s++){r=e[s]*2;i=s*2;n[i]=t[r];n[i+1]=t[r+1]}return n.toString("ucs2")}function loadEncodings(){if(!iconv.encodingsLoaded){[require("./encodings/singlebyte"),require("./encodings/gbk"),require("./encodings/big5")].forEach(function(e){for(var t in e)iconv.encodings[t]=e[t]});iconv.encodingsLoaded=!0}}var RE_SPACEDASH=/[- ]/g,iconv=module.exports={toEncoding:function(e,t){return iconv.getCodec(t).toEncoding(e)},fromEncoding:function(e,t){return iconv.getCodec(t).fromEncoding(e)},encodingExists:function(e){loadEncodings();e=e.replace(RE_SPACEDASH,"").toLowerCase();return iconv.encodings[e]!==undefined},defaultCharUnicode:"ï¿½",defaultCharSingleByte:"?",encodingsLoaded:!1,getCodec:function(e){loadEncodings();var t=e||"utf8",n=undefined;for(;;){getType(t)==="String"&&(t=t.replace(RE_SPACEDASH,"").toLowerCase());var r=iconv.encodings[t],i=getType(r);if(i==="String"){n={originalEncoding:t};t=r}else{if(i!=="Object"||r.type==undefined){if(i==="Function")return r(n);throw new Error("Encoding not recognized: '"+e+"' (searched as: '"+t+"')")}n=r;t=r.type}}},encodings:{internal:function(e){return{toEncoding:toInternalEncoding,fromEncoding:fromInternalEncoding,options:e}},utf8:"internal",ucs2:"internal",binary:"internal",ascii:"internal",base64:"internal",singlebyte:function(e){if(!e.charsBuf){if(!e.chars||e.chars.length!==128&&e.chars.length!==256)throw new Error("Encoding '"+e.type+"' has incorrect 'chars' (must be of len 128 or 256)");e.chars.length===128&&(e.chars=asciiString+e.chars);e.charsBuf=new Buffer(e.chars,"ucs2")}if(!e.revCharsBuf){e.revCharsBuf=new Buffer(65536);var t=iconv.defaultCharSingleByte.charCodeAt(0);for(var n=0;n<e.revCharsBuf.length;n++)e.revCharsBuf[n]=t;for(var n=0;n<e.chars.length;n++)e.revCharsBuf[e.chars.charCodeAt(n)]=n}return{toEncoding:toSingleByteEncoding,fromEncoding:fromSingleByteEncoding,options:e}},table:function(e){if(!e.table)throw new Error("Encoding '"+e.type+"' has incorect 'table' option");if(!e.revCharsTable){var t=e.revCharsTable={};for(var n=0;n<=65535;n++)t[n]=0;var r=e.table;for(var i in r)t[r[i]]=+i}return{toEncoding:toTableEncoding,fromEncoding:fromTableEncoding,options:e}}}};iconv.encode=iconv.toEncoding;iconv.decode=iconv.fromEncoding;var asciiString="\0\b	\n\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",ensureBuffer=function(e){e=e||new Buffer(0);return e instanceof Buffer?e:new Buffer(""+e,"binary")},ensureString=function(e){e=e||"";return e instanceof Buffer?e.toString("utf8"):""+e},getType=function(e){return Object.prototype.toString.call(e).slice(8,-1)};