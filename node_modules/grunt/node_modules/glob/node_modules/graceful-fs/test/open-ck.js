var test=require("tap").test,fs=require("../graceful-fs.js");test("graceful fs is not fs",function(e){e.notEqual(fs,require("fs"));e.end()});test("open an existing file works",function(e){var t=fs._curOpen,n=fs.openSync(__filename,"r");e.equal(fs._curOpen,t+1);fs.closeSync(n);e.equal(fs._curOpen,t);fs.open(__filename,"r",function(n,r){if(n)throw n;e.equal(fs._curOpen,t+1);fs.close(r,function(n){if(n)throw n;e.equal(fs._curOpen,t);e.end()})})});test("open a non-existing file throws",function(e){var t=fs._curOpen,n;try{var r=fs.openSync("this file does not exist","r")}catch(i){n=i}e.ok(n,"should throw");e.notOk(r,"should not get an fd");e.equal(n.code,"ENOENT");e.equal(fs._curOpen,t);fs.open("neither does this file","r",function(n,r){e.ok(n,"should throw");e.notOk(r,"should not get an fd");e.equal(n.code,"ENOENT");e.equal(fs._curOpen,t);e.end()})});